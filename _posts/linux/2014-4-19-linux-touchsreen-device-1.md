---

layout: post
title: "linux 电容触摸屏驱动-1"
date: 2014-4-19 13:34
category: "学习"
comments: false
tags : "driver"

---

###触摸屏
触摸屏（touch screen）又称为“触控屏”、“触控面板”，是一种可接收触头等输入讯号的感应式液晶显示装置，当接触了屏幕上的图形按钮时，屏幕上的触觉反馈系统可根据预先编程的程式驱动各种连结装置，可用以取代机械式的按钮面板，并借由液晶显示画面制造出生动的影音效果.使用最广最多的有下面的两种触摸屏：

- 电阻式触摸屏             

	这种触摸屏利用压力感应进行控制触摸屏触摸屏.电阻触摸屏的主要部分是一块与显示器表面非常配合的电阻薄膜屏，这是一种多层的复合薄膜，它以一层玻璃或硬塑料平板作为基层，表面涂有一层透明氧化金属（透明的导电电阻）导电层，上面再盖有一层外表面硬化处理、光滑防擦的塑料层、它的内表面也涂有一层涂层、在他们之间有许多细小的（小于1/1000英寸）的透明隔离点把两层导电层隔开绝缘。当手指触摸屏幕时，两层导电层在触摸点位置就有了接触，电阻发生变化，在X和Y两个方向上产生信号，然后送触摸屏控制器。控制器侦测到这一接触并计算出（X，Y）的位置，再根据模拟鼠标的方式运作。这就是电阻技术触摸屏的最基本的原理.一般驱动这种屏幕需要使用到处理器的AD引脚进行模式转化.电阻触摸屏的精度只取决于A/D转换的精度.
	
- 电容

	是利用人体的电流感应进行工作的。电容式触摸屏是一块四层复合玻璃屏，玻璃屏的内表面和夹层各涂有一层ITO，最外层是一薄层矽土玻璃保护层,夹层ITO涂层作为工作面，四个角上引出四个电极，内层ITO为屏蔽层以保证良好的工作环境。当手指触摸在金属层上时，由于人体电场，用户和触摸屏表面形成以一个耦合电容，对于高频电流来说，电容是直接导体，于是手指从接触点吸走一个很小的电流。这个电流分从触摸屏的四角上的电极中流出，并且流经这四个电极的电流与手指到四角的距离成正比，控制器通过对这四个电流比例的精确计算，得出触摸点的位置.电容屏的缺点是用戴手套的手或手持不导电的物体触摸时没有反应，这是因为增加了更为绝缘的介质.电容触摸屏采用的这种四个角的自定义极坐标系还没有坐标上的原点，漂移后控制器不能察觉和恢复，而且，4个A/D完成后，由四个分流量的值到触摸点在直角坐标系上的X、Y坐标值的计算过程复杂。由于没有原点，电容屏的漂移是累积的，在工作现场也经常需要校准。电容触摸屏最外面的矽土保护玻璃防刮擦性很好，但是怕指甲或硬物的敲击，敲出一个小洞就会伤及夹层ITO，不管是伤及夹层ITO还是安装运输过程中伤及内表面ITO层，电容屏就不能正常工作了。

- 压电式触摸屏

	电阻式设计简单，成本低，但电阻式触控较受制于其物理局限性，如透光率较低，高线数的大侦测面积造成处理器负担，其应用特性使之易老化从而影响使用寿命。电容式触控支持多点触控功能，拥有更高的透光率、更低的整体功耗，其接触面硬度高，无需按压，使用寿命较长，但精准度不足，不支持手写笔操控。于是衍生了压电式触摸屏。
	压电式触控技术介于电阻式与电容式触控技术之间。压电式传感器的触控屏幕同电容式触控屏一样支持多点触控，而且支持任何物体触控，不像电容屏只支持类皮肤的材质触控。这样，压电式触控屏幕可以同时具有电容屏幕的多点触控触感，又具有电阻屏的精准。
	压电式触控在耗电特性上更接近电容式触控特性，即没有触摸的动作，就不产生耗电，而电阻式则时刻产生耗电。在接口支持上，压电式触控也同样支持串口、I2C和USB接口。从工艺成本上看，电阻式触控制程转到压电式触控制程需要变更生产线设备，而同电容式的ITO和掩模结合的制程相比，压电式触控制程成本约在其80-90%之间。
	压电触摸屏的工作原理相当于TFT，制造工艺部分像电容式触摸屏，物理结构又像电阻式触摸屏，是三种成熟技术的揉和。所以采用新技术的压电式触摸屏集合并增强了电阻式和电容式的优点，又避免了二者的缺点。压电触摸屏一般为硬塑料平板（或有机玻璃）底材多层复合膜，硬塑料平板（或有机玻璃）作为基层，表面涂有一层透明的导电层，上面再盖有一层外表面经过硬化处理、光滑防刮的塑料层，它的表面也涂有一层透明的导电层，在两层导电层之间有许多细小的透明隔离点。屏体的透光度略低于玻璃。
	压电式触摸屏的代表作是智器Ten（即T10），压电式IPS硬屏，近乎达到了iPad同级的显示效果和触控体验，同时成本更低，表现非常不错。


###i2c电容触摸屏

webee210v2采用的是[FT5X06](http://www.buydisplay.com/download/ic/FT5206.pdf)的电容式触摸屏驱动芯片。他以下特性:

- 12bit ADC转换
- 最大支持8'9寸
- 支持多点触摸，最多10点
- 具有i2c和SPI两种数据接口

FT5x06具体信号的区别如下:

![ft5x061](/picture/ft5x061.png "ft5x061")

我们将以ft5306为例子，看看他的linux驱动如何编写
